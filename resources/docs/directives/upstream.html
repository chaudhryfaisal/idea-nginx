<h2><span class="mw-headline" id="upstream"> upstream </span></h2>
<table cellspacing="0">
                <tr>
                <th>
            Syntax:
                </th>
                <td>
            <code><strong>upstream</strong> <code><i>name</i></code> { ... }</code><br>
                </td>
                </tr>
            
                <tr>
                <th>
            Default:
                </th>
                <td>
            
            â€”
        
                </td>
                </tr>
            
                <tr>
                <th>
            Context:
                </th>
                <td>
            <code>stream</code><br>
                </td>
                </tr>
            </table></div><p>
Defines a group of servers.
Servers can listen on different ports.
In addition, servers listening on TCP and UNIX-domain sockets
can be mixed.
</p><p>
Example:
</p> <blockquote class="example"><pre>
upstream backend {
    server backend1.example.com:12345 weight=5;
    server 127.0.0.1:12345            max_fails=3 fail_timeout=30s;
    server unix:/tmp/backend2;
    server backend3.example.com:12345 resolve;
    server backup1.example.com:12345  backup;
}
</pre></blockquote><p> 
</p><p>
By default, connections are distributed between the servers using a
weighted round-robin balancing method.
In the above example, each 7 connections will be distributed as follows:
5 connections go to <code>backend1.example.com:12345</code>
and one connection to each of the second and third servers.
If an error occurs during communication with a server, the connection will
be passed to the next server, and so on until all of the functioning
servers will be tried.
If communication with all servers fails, the connection will be closed.
</p><a name="server"></a>

<span>[<a href="http://nginx.org/en/docs/stream/ngx_stream_upstream_module.html#upstream">upstream</a>]</span>
